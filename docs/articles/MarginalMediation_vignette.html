<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marginal Mediation • MarginalMediation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Marginal Mediation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MarginalMediation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MarginalMediation_vignette.html">Marginal Mediation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Marginal Mediation</h1>
            
            <h4 data-toc-skip class="date">2026-01-17</h4>
      

      <div class="hidden name"><code>MarginalMediation_vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="what-is-marginal-mediation">What is “Marginal Mediation”<a class="anchor" aria-label="anchor" href="#what-is-marginal-mediation"></a>
</h2>
<p>Marginal Mediation is the general method of interpreting indirect and
direct effects in terms of the average marginal effects. When the
mediator(s) and outcome are continuous, this is the same as the normal
<code>a x b</code> method. When either the mediator(s) or outcome is
dichotomous, then it allows a simple transformation from the log-odds
scale to probability.</p>
<p>For example, when the mediator is dichotomous and the outcome is
continuous, we have a probability times a value in the unit of the
outcome. Simply, the resulting indirect or total effect is in the units
of the outcome.</p>
</div>
<div class="section level2">
<h2 id="how-to-use-marginalmediation">How to Use <code>MarginalMediation</code><a class="anchor" aria-label="anchor" href="#how-to-use-marginalmediation"></a>
</h2>
<p>To demonstrate the main functions in <code>MarginalMediation</code>,
we are going to use a data set from the <code>furniture</code> package
called <code>nhanes_2010</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">furniture</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nhanes_2010"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nhanes_2010</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "id"         "gen_health" "mod_active" "vig_active" "home_meals"</span></span>
<span><span class="co">##  [6] "gender"     "age"        "marijuana"  "illicit"    "rehab"     </span></span>
<span><span class="co">## [11] "asthma"     "overweight" "cancer"     "low_int"    "down"      </span></span>
<span><span class="co">## [16] "sleeping"   "low_energy" "appetite"   "feel_bad"   "no_con"    </span></span>
<span><span class="co">## [21] "speak_move" "dead"       "difficulty" "active"</span></span></code></pre>
<div class="section level3">
<h3 id="mma">
<code>mma()</code><a class="anchor" aria-label="anchor" href="#mma"></a>
</h3>
<p>This is the main function of the package. It takes data, two (or more
in the future) formulas relating to the outcome and mediators, the
family of the generalized linear model (GLM) regression functions, the
indirect effects to compute, and the number of bootstrapped samples.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pathbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">marijuana</span> <span class="op">~</span> <span class="va">home_meals</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">asthma</span>, </span>
<span>              data <span class="op">=</span> <span class="va">nhanes_2010</span>, </span>
<span>              family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="va">patha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">home_meals</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">asthma</span>,</span>
<span>             data <span class="op">=</span> <span class="va">nhanes_2010</span>, </span>
<span>             family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/mma.html">mma</a></span><span class="op">(</span><span class="va">pathbc</span>, <span class="va">patha</span>,</span>
<span>    ind_effects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"genderFemale-home_meals"</span>,</span>
<span>                    <span class="st">"age-home_meals"</span>,</span>
<span>                    <span class="st">"asthmaNo-home_meals"</span><span class="op">)</span>,</span>
<span>    boot <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## calculating a paths... b and c paths... Done.                                                                                 </span></span></code></pre>
<pre><code><span><span class="co">## ┌───────────────────────────────┐</span></span>
<span><span class="co">## │  Marginal Mediation Analysis  │</span></span>
<span><span class="co">## └───────────────────────────────┘</span></span>
<span><span class="co">## A marginal mediation model with:</span></span>
<span><span class="co">##    1 mediators</span></span>
<span><span class="co">##    3 indirect effects</span></span>
<span><span class="co">##    3 direct effects</span></span>
<span><span class="co">##    500 bootstrapped samples</span></span>
<span><span class="co">##    95% confidence interval</span></span>
<span><span class="co">##    n = 1417 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formulas:</span></span>
<span><span class="co">##    ◌ marijuana ~ home_meals + gender + age + asthma</span></span>
<span><span class="co">##    ◌ home_meals ~ gender + age + asthma </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Regression Models: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      marijuana ~ </span></span>
<span><span class="co">##                           Est      SE   Est/SE P-Value</span></span>
<span><span class="co">##         (Intercept)  -0.39400 0.38028 -1.03608 0.30017</span></span>
<span><span class="co">##         home_meals   -0.04062 0.01363 -2.98051 0.00288</span></span>
<span><span class="co">##         genderFemale  0.43161 0.11723  3.68169 0.00023</span></span>
<span><span class="co">##         age           0.00276 0.01470  0.18754 0.85123</span></span>
<span><span class="co">##         asthmaNo     -0.00717 0.15004 -0.04778 0.96189</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      home_meals ~ </span></span>
<span><span class="co">##                           Est      SE   Est/SE P-Value</span></span>
<span><span class="co">##         (Intercept)   6.56883 0.76462  8.59100 0.00000</span></span>
<span><span class="co">##         genderFemale -1.34831 0.23910 -5.63913 0.00000</span></span>
<span><span class="co">##         age          -0.05689 0.03017 -1.88565 0.05955</span></span>
<span><span class="co">##         asthmaNo     -0.00428 0.31293 -0.01368 0.98909</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Unstandardized Mediated Effects: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Indirect Effects: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      marijuana ~ </span></span>
<span><span class="co">##                                    Indirect    Lower   Upper</span></span>
<span><span class="co">##         genderFemale =&gt; home_meals  0.01312  0.00432 0.02510</span></span>
<span><span class="co">##         age =&gt; home_meals           0.00055 -0.00003 0.00136</span></span>
<span><span class="co">##         asthmaNo =&gt; home_meals      0.00004 -0.00732 0.00614</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Direct Effects: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      marijuana ~ </span></span>
<span><span class="co">##                        Direct    Lower   Upper</span></span>
<span><span class="co">##         genderFemale  0.10430  0.04416 0.15939</span></span>
<span><span class="co">##         age           0.00066 -0.00661 0.00837</span></span>
<span><span class="co">##         asthmaNo     -0.00172 -0.07001 0.06706</span></span></code></pre>
<p>The print method of MMA shows:</p>
<ol style="list-style-type: decimal">
<li>information about the overall model,</li>
<li>the individual regression models,</li>
<li>the indirect effect (<code>a x b</code>) with its confidence
interval, and</li>
<li>the direct effect with its confidence interval.</li>
</ol>
<p>These estimates are all average marginal effects, meaning each are
interpreted in terms of the corresponding endogenous variable’s original
units. In this example, since marijuana is binary, its original units
are probabilities. That means that the indirect and direct effects are
risks (or probabilities) of using marijuana.</p>
</div>
<div class="section level3">
<h3 id="frames">
<code>frames()</code><a class="anchor" aria-label="anchor" href="#frames"></a>
</h3>
<p>This function provides the average marginal effects of a GLM model’s
parameters. Its syntax is similar to that of <code><a href="../reference/mma.html">mma()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/frames.html">frames</a></span><span class="op">(</span><span class="va">pathbc</span>,</span>
<span>       boot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Bootstrapping...Done.                                                                                 </span></span></code></pre>
<pre><code><span><span class="co">## ┌────────────────────────────┐</span></span>
<span><span class="co">## │  Average Marginal Effects  │</span></span>
<span><span class="co">## └────────────────────────────┘</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##              Estimate   Lower   Upper</span></span>
<span><span class="co">## home_meals    -0.0097 -0.0171 -0.0021</span></span>
<span><span class="co">## genderFemale   0.1043  0.0529  0.1556</span></span>
<span><span class="co">## age            0.0007 -0.0050  0.0088</span></span>
<span><span class="co">## asthmaNo      -0.0017 -0.0747  0.0786</span></span>
<span><span class="co">## ────</span></span></code></pre>
<p>We can compare these results to those from the remarkable
<code>margins</code> package found at <a href="https://github.com/leeper/margins" class="external-link">https://github.com/leeper/margins</a>
from Thomas Leeper. We won’t show them here, but the estimates are the
same as those from the <code><a href="../reference/frames.html">frames()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"leeper/margins"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/margins" class="external-link">margins</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">margins</span><span class="op">(</span><span class="va">pathbc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The differences are mainly in the confidence intervals since they are
based on two different methods. I highly recommend looking into both the
delta method (as used in <code>margins</code> and Stata) as well as the
bootstrapping method as used in <code>MarginalMediation</code>.</p>
</div>
<div class="section level3">
<h3 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h3>
<p>This is currently beta but I am excited to provide an initial working
release. Let me know if you find any bugs or want to discuss the method
(<a href="mailto:t.barrett@aggiemail.usu.edu" class="email">t.barrett@aggiemail.usu.edu</a>).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tyson S Barrett.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
